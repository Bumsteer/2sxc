/*! ToSic_ToSxc 2015-06-26 */

!function(){window.$2sxc||(window.$2sxc=function(a){$2sxc._data[a]||($2sxc._data[a]={});var b=$2sxc._controllers[a]?$2sxc._controllers[a]:$2sxc._controllers[a]={serviceScopes:["app-api","app-query","app-content","eav","view"],serviceRoot:$.ServicesFramework(a).getServiceRoot("2sxc"),resolveServiceUrl:function(a){var c=a.split("/")[0].toLowerCase();return-1==b.serviceScopes.indexOf(c)?a:b.serviceRoot+c+"/"+a.substring(a.indexOf("/")+1)},data:{sourceUrl:function(b){var c=window.location.href;return c.indexOf("#")&&(c=c.substr(0,c.indexOf("#"))),c+=(-1!=window.location.href.indexOf("?")?"&":"?")+"mid="+a+"&standalone=true&popUp=true&type=data","string"==typeof b&&(c+="&"+b),c},"in":{},List:[],controller:null,load:function(a){return a&&a.List?(b.data.setData(a),b.data):(a||(a={}),a.url||(a.url=b.data.sourceUrl()),a.origSuccess=a.success,a.success=function(c){for(var d in c)null!=c[d].List&&(b.data["in"][d]=c[d],b.data["in"][d].name=d);b.data["in"].Default&&(b.List=b.data["in"].Default.List),a.origSuccess&&a.origSuccess(b.data),b.isLoaded=!0,b.lastRefresh=new Date,b.data._triggerLoaded()},a.error=function(a){alert(JSON.parse(a.responseText).error)},b.data.source=a,b.data.reload())},reload:function(a){return a&&(b.data.source.success=a),$.ajax(b.data.source),b.data},on:function(a,c){return $(b.data).bind("2scLoad",c)[0]._triggerLoaded()},_triggerLoaded:function(){return b.isLoaded?$(b.data).trigger("2scLoad",[b.data])[0]:b.data},one:function(a,c){return b.isLoaded?(c({},b.data),b.data):$(b.data).one("2scLoad",c)[0]}},id:a,source:null,isLoaded:!1,lastRefresh:null,manage:$2sxc.getManageController?$2sxc.getManageController(a):null,isEditMode:function(){return b.manage&&b.manage.isEditMode()},webApi:{get:function(a,c,d,e){return b.webApi._action(a,c,d,e,"GET")},post:function(a,c,d,e){return b.webApi._action(a,c,d,e,"POST")},"delete":function(a,c,d,e){return b.webApi._action(a,c,d,e,"DELETE")},put:function(a,c,d,e){return b.webApi._action(a,c,d,e,"PUT")},_action:function(c,d,e,f,g){if("object"!=typeof d&&"undefined"!=typeof d&&(d={id:d}),"string"==typeof c){var h=c.split("/"),i=h[0],j=h[1];(""==i||""==j)&&alert("Error: controller or action not defined. Will continue with likely errors."),c={controller:i,action:j,params:d,data:e,preventAutoFail:f}}var k={method:null==g?"POST":g,params:null,preventAutoFail:!1};c=$.extend({},k,c);var l=$.ServicesFramework(a),m=$.ajax({type:c.method,dataType:"json",async:!0,data:JSON.stringify(c.data),contentType:"application/json",url:b.webApi.getActionUrl(c),beforeSend:l.setModuleHeaders});return c.preventAutoFail||m.fail(b.showDetailedHttpError),m},getActionUrl:function(b){var c=$.ServicesFramework(a);return c.getServiceRoot("2sxc")+"app-api/"+b.controller+"/"+b.action+(null==b.params?"":"?"+$.param(b.params))}},showDetailedHttpError:function(a){if(window.console&&console.log(a),0!=a.status){var b="Had an error talking to the server (status "+a.status+").",c=a.responseText?JSON.parse(a.responseText):a.data;if(c){var d=c.Message;d&&(b+="\n\nMessage: "+d);var e=c.MessageDetail;e&&(b+="\n\nDetail: "+e),e&&0==e.indexOf("No action was found")&&(e.indexOf("that matches the name")>0?b+="\n\nTip from 2sxc: you probably got the action-name wrong in your JS.":e.indexOf("that matches the request.")>0&&(b+="\n\nTip from 2sxc: Seems like the parameters are the wrong amount or type.")),0==d.indexOf("Controller")&&d.indexOf("not found")>0&&(b+="\n\nTip from 2sxc: you probably spelled the controller name wrong or forgot to remove the word 'controller' from the call in JS. To call a controller called 'DemoController' only use 'Demo'.")}b+="\n\nFor further debugging view the JS-console or use fiddler. ",alert(b)}}};return b.data.controller=b,b},$2sxc._controllers={},$2sxc.metaName="The 2sxc Controller object",$2sxc.metaVersion="07.00.03",$2sxc.beta={},$2sxc._data={})}();
//# sourceMappingURL=2sxc.api.min.js.map